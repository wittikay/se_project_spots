!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},o=(e,t,o)=>{const r=e.querySelector(`#${t.id}-error`);r.textContent="",r.classList.remove(o.errorClass),t.classList.remove(o.inputErrorClass)},r=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},n=(e,t,o)=>{(e=>e.some((e=>!e.validity.valid)))(e)?r(t,o):(t.disabled=!1,t.classList.remove(o.inactiveButtonClass))},l=(e,t,r)=>{t.forEach((t=>{o(e,t,r)}))};var a;a=t,document.querySelectorAll(a.formSelector).forEach((e=>{((e,t)=>{const r=Array.from(e.querySelectorAll(t.inputSelector)),l=e.querySelector(t.submitButtonSelector);n(r,l,t),r.forEach((a=>{a.addEventListener("input",(()=>{((e,t,r)=>{t.validity.valid?o(e,t,r):((e,t,o,r)=>{const n=e.querySelector(`#${t.id}-error`);n.textContent=o,n.classList.add(r.errorClass),t.classList.add(r.inputErrorClass)})(e,t,t.validationMessage,r)})(e,a,t),n(r,l,t)}))}))})(e,a)}));var i=e+"d3610e9c6dce3cb370d8.svg",c=e+"2fc47fd8e9a9bcd9612f.jpg",s=e+"d38272e02bb4f1ab1c37.svg",d=e+"40608da7369d39bc1077.svg",m=e+"a8e301eb86866b1df117.svg",u=e+"53f0bab7ec2e970778f9.svg";const f=document.getElementById("header__logo"),p=document.getElementById("profile__image"),b=document.getElementById("profile__edit-btn-img"),_=document.getElementById("profile__add-btn-img"),y=document.getElementById("modal__close-btn-img-edit"),v=document.getElementById("modal__close-btn-img-add"),w=document.getElementById("modal__close-btn-img-whte");f.src=i,p.src=c,y.src=m,v.src=m,b.src=s,_.src=d,w.src=u;const x=document.querySelector(".profile__edit-btn"),g=document.querySelector("#edit-profile-modal"),S=g.querySelector(".modal__close-btn"),q=document.forms["edit-profile"],h=document.querySelector(".profile__name"),E=document.querySelector(".profile__description"),k=g.querySelector("#name"),B=g.querySelector("#description"),L=e=>{e.classList.add("modal_is-opened"),document.addEventListener("keydown",X),e.addEventListener("click",U)},H=function(e){e.classList.remove("modal_is-opened"),document.removeEventListener("keydown",X),e.removeEventListener("click",U)},D=(e,t)=>{e.addEventListener("click",(()=>H(t)))};x.addEventListener("click",(()=>{k.value=h.textContent,B.value=E.textContent;const e=Array.from(q.querySelectorAll(t.inputSelector));l(q,e,t),L(g)})),D(S,g),q.addEventListener("submit",(function(e){e.preventDefault(),h.textContent=k.value,E.textContent=B.value,H(g)}));const M=document.querySelector(".profile__add-btn"),C=document.querySelector("#new-post-modal"),A=C.querySelector(".modal__close-btn"),Z=document.querySelector(".modal__submit-btn"),I=C.querySelector(".modal__form"),V=C.querySelector("#link"),j=C.querySelector("#caption");var G;G=C,M.addEventListener("click",(()=>L(G))),D(A,C),M.addEventListener("click",(()=>{I.reset();const e=Array.from(I.querySelectorAll(t.inputSelector));l(I,e,t),r(I.querySelector(t.submitButtonSelector),t),L(C)}));const W=document.getElementById("preview-modal"),R=W.querySelector(".modal__close-btn_preview"),Y=W.querySelector(".modal__image"),F=W.querySelector(".modal__caption"),z=(e,t)=>{const o=function(e){const t=T.cloneNode(!0),o=t.querySelector(".card__title"),r=t.querySelector(".card__image");o.textContent=e.name,r.alt=e.name,r.src=e.link;(e=>{e.addEventListener("click",(()=>{e.classList.toggle("card__like-btn_active")}))})(t.querySelector(".card__like-btn"));return((e,t)=>{e.addEventListener("click",(()=>{t.remove()}))})(t.querySelector(".card__del-btn"),t),((e,t)=>{e.addEventListener("click",(()=>{Y.src=t.link,Y.alt=t.name,F.textContent=t.name,L(W)}))})(r,e),t}(e);t.prepend(o)};I.addEventListener("submit",(function(e){e.preventDefault();const o={name:j.value,link:V.value};z(o,J),I.reset(),r(Z,t),H(C)}));const J=document.querySelector(".cards__list"),T=document.getElementById("cards__template").content.querySelector(".card");D(R,W),[{name:"Landscape example",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/7-photo-by-griffin-wooldridge-from-pexels.jpg"},{name:"A multi-story library filled with bookshelves.",link:"https://images.unsplash.com/photo-1741850820882-1cb02da0f04f?w=1200&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxmZWF0dXJlZC1waG90b3MtZmVlZHw1MHx8fGVufDB8fHx8fA%3D%3D"},{name:"A proud lioness rests admist her pride.",link:"https://images.unsplash.com/photo-1741850820591-f6954a90c7ba?w=1200&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxmZWF0dXJlZC1waG90b3MtZmVlZHw1MXx8fGVufDB8fHx8fA%3D%3D"},{name:"A modern, angular building with a large window.",link:"https://images.unsplash.com/photo-1741540420762-91a78becdf92?w=1200&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHx0b3BpYy1mZWVkfDE5fE04alZiTGJUUndzfHxlbnwwfHx8fHw%3D"},{name:"People pray at a temple with incense smoke.",link:"https://images.unsplash.com/photo-1742268351334-bf9328f293ce?w=1200&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHx0b3BpYy1mZWVkfDI2fHRvd0paRnNrcEdnfHxlbnwwfHx8fHw%3D"},{name:"Two people holding hands over coffee.",link:"https://images.unsplash.com/photo-1741217531460-fb52b48107b6?w=1200&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHx0b3BpYy1mZWVkfDEzfHhqUFI0aGxrQkdBfHxlbnwwfHx8fHw%3D"},{name:"Gray metal chalkboard with whatever it takes written.",link:"https://images.unsplash.com/photo-1491234323906-4f056ca415bc?w=1200&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHx0b3BpYy1mZWVkfDE5fF9oYi1kbDRRLTRVfHxlbnwwfHx8fHw%3D"}].forEach((e=>{z(e,J)}));const U=e=>{e.target.classList.contains("modal_is-opened")&&H(e.target)},X=e=>{if("Escape"===e.key){const e=document.querySelector(".modal_is-opened");e&&H(e)}}}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQ0EsSUFBSUEsRUNEb0IsR0NBakIsTUFBTUMsRUFBVyxDQUN0QkMsYUFBYyxlQUNkQyxjQUFlLGdCQUNmQyxxQkFBc0IscUJBQ3RCQyxvQkFBcUIseUJBQ3JCQyxnQkFBaUIsMEJBQ2pCQyxXQUFZLGdCQVVSQyxFQUFpQkEsQ0FBQ0MsRUFBUUMsRUFBU0MsS0FDdkMsTUFBTUMsRUFBYUgsRUFBT0ksY0FBYyxJQUFJSCxFQUFRSSxZQUNwREYsRUFBV0csWUFBYyxHQUN6QkgsRUFBV0ksVUFBVUMsT0FBT04sRUFBT0osWUFDbkNHLEVBQVFNLFVBQVVDLE9BQU9OLEVBQU9MLGtCQWdCckJZLEVBQWFBLENBQUNDLEVBQVVSLEtBQ25DUSxFQUFTQyxVQUFXLEVBQ3BCRCxFQUFTSCxVQUFVSyxJQUFJVixFQUFPTixzQkFFMUJpQixFQUFvQkEsQ0FBQ0MsRUFBU0osRUFBVVIsS0FWckJZLElBQ2hCQSxFQUFRQyxNQUFNZCxJQUNYQSxFQUFRZSxTQUFTQyxRQVN2QkMsQ0FBZ0JKLEdBQ2xCTCxFQUFXQyxFQUFVUixJQUVyQlEsRUFBU0MsVUFBVyxFQUNwQkQsRUFBU0gsVUFBVUMsT0FBT04sRUFBT04sdUJBb0J4QnVCLEVBQWtCQSxDQUFDbkIsRUFBUWMsRUFBU1osS0FDL0NZLEVBQVFNLFNBQVNuQixJQUNmRixFQUFlQyxFQUFRQyxFQUFTQyxPQVJIQSxRQVdoQlYsRUFWQTZCLFNBQVNDLGlCQUFpQnBCLEVBQU9ULGNBQ3pDMkIsU0FBU3BCLElBYlF1QixFQUFDdkIsRUFBUUUsS0FDakMsTUFBTVksRUFBVVUsTUFBTUMsS0FBS3pCLEVBQU9zQixpQkFBaUJwQixFQUFPUixnQkFDcERnQixFQUFXVixFQUFPSSxjQUFjRixFQUFPUCxzQkFDN0NrQixFQUFrQkMsRUFBU0osRUFBVVIsR0FDckNZLEVBQVFNLFNBQVNuQixJQUNmQSxFQUFReUIsaUJBQWlCLFNBQVMsS0E5QlhDLEVBQUMzQixFQUFRQyxFQUFTQyxLQUN0Q0QsRUFBUWUsU0FBU0MsTUFHcEJsQixFQUFlQyxFQUFRQyxFQUFTQyxHQWxCYjBCLEVBQUM1QixFQUFRQyxFQUFTNEIsRUFBVTNCLEtBQ2pELE1BQU1DLEVBQWFILEVBQU9JLGNBQWMsSUFBSUgsRUFBUUksWUFDcERGLEVBQVdHLFlBQWN1QixFQUN6QjFCLEVBQVdJLFVBQVVLLElBQUlWLEVBQU9KLFlBQ2hDRyxFQUFRTSxVQUFVSyxJQUFJVixFQUFPTCxrQkFZM0IrQixDQUFlNUIsRUFBUUMsRUFBU0EsRUFBUTZCLGtCQUFtQjVCLElBNkJ6RHlCLENBQW1CM0IsRUFBUUMsRUFBU0MsR0FDcENXLEVBQWtCQyxFQUFTSixFQUFVUixVQU92Q3FCLENBQWtCdkIsRUFBUUUsTSw4TEM5QzlCLE1BQU02QixFQUFhVixTQUFTVyxlQUFlLGdCQUNyQ0MsRUFBYVosU0FBU1csZUFBZSxrQkFDckNFLEVBQWlCYixTQUFTVyxlQUFlLHlCQUN6Q0csRUFBZ0JkLFNBQVNXLGVBQWUsd0JBQ3hDSSxFQUFrQmYsU0FBU1csZUFBZSw2QkFFMUNLLEVBQWlCaEIsU0FBU1csZUFBZSw0QkFDekNNLEVBQWNqQixTQUFTVyxlQUFlLDZCQUU1Q0QsRUFBV1EsSUFBTUMsRUFDakJQLEVBQVdNLElBQU1FLEVBQ2pCTCxFQUFnQkcsSUFBTUcsRUFDdEJMLEVBQWVFLElBQU1HLEVBQ3JCUixFQUFlSyxJQUFNSSxFQUNyQlIsRUFBY0ksSUFBTUssRUFFcEJOLEVBQVlDLElBQU1NLEVBRWxCLE1BcUNNQyxFQUFpQnpCLFNBQVNqQixjQUFjLHNCQUN4QzJDLEVBQW1CMUIsU0FBU2pCLGNBQWMsdUJBQzFDNEMsRUFBb0JELEVBQWlCM0MsY0FBYyxxQkFDbkQ2QyxFQUFrQjVCLFNBQVM2QixNQUFNLGdCQUVqQ0MsRUFBYzlCLFNBQVNqQixjQUFjLGtCQUNyQ2dELEVBQXFCL0IsU0FBU2pCLGNBQWMseUJBQzVDaUQsRUFBa0JOLEVBQWlCM0MsY0FBYyxTQUNqRGtELEVBQXlCUCxFQUFpQjNDLGNBQWMsZ0JBRXhEbUQsRUFBYUMsSUFDakJBLEVBQU1qRCxVQUFVSyxJQUFJLG1CQUNwQlMsU0FBU0ssaUJBQWlCLFVBQVcrQixHQUNyQ0QsRUFBTTlCLGlCQUFpQixRQUFTZ0MsSUFHNUJDLEVBQWEsU0FBVUgsR0FDM0JBLEVBQU1qRCxVQUFVQyxPQUFPLG1CQUN2QmEsU0FBU3VDLG9CQUFvQixVQUFXSCxHQUN4Q0QsRUFBTUksb0JBQW9CLFFBQVNGLEVBQ3JDLEVBTU1HLEVBQXdCQSxDQUFDQyxFQUFRTixLQUNyQ00sRUFBT3BDLGlCQUFpQixTQUFTLElBQU1pQyxFQUFXSCxNQXdCcERWLEVBQWVwQixpQkFBaUIsU0FBUyxLQUN2QzJCLEVBQWdCVSxNQUFRWixFQUFZN0MsWUFDcENnRCxFQUF1QlMsTUFBUVgsRUFBbUI5QyxZQUNsRCxNQUFNUSxFQUFVVSxNQUFNQyxLQUNwQndCLEVBQWdCM0IsaUJBQWlCOUIsRUFBU0UsZ0JBRTVDeUIsRUFBZ0I4QixFQUFpQm5DLEVBQVN0QixHQUMxQytELEVBQVVSLE1BRVpjLEVBQXNCYixFQUFtQkQsR0FTekNFLEVBQWdCdkIsaUJBQWlCLFVBUGpDLFNBQWlDc0MsR0FDL0JBLEVBQUlDLGlCQUNKZCxFQUFZN0MsWUFBYytDLEVBQWdCVSxNQUMxQ1gsRUFBbUI5QyxZQUFjZ0QsRUFBdUJTLE1BQ3hESixFQUFXWixFQUNiLElBS0EsTUFBTW1CLEVBQWdCN0MsU0FBU2pCLGNBQWMscUJBQ3ZDK0QsRUFBa0I5QyxTQUFTakIsY0FBYyxtQkFDekNnRSxFQUFtQkQsRUFBZ0IvRCxjQUFjLHFCQUNqRGlFLEVBQWVoRCxTQUFTakIsY0FBYyxzQkFDdENrRSxFQUFpQkgsRUFBZ0IvRCxjQUFjLGdCQUUvQ21FLEVBQWlCSixFQUFnQi9ELGNBQWMsU0FDL0NvRSxFQUFvQkwsRUFBZ0IvRCxjQUFjLFlBekQzQnFFLElBQVVqQixJQTJESFcsRUFBZkQsRUExRFh4QyxpQkFBaUIsU0FBUyxJQUFNNkIsRUFBVUMsS0EyRHBESyxFQUFzQk8sRUFBa0JELEdBRXhDRCxFQUFjeEMsaUJBQWlCLFNBQVMsS0FDdEM0QyxFQUFlSSxRQUNmLE1BQU01RCxFQUFVVSxNQUFNQyxLQUNwQjZDLEVBQWVoRCxpQkFBaUI5QixFQUFTRSxnQkFFM0N5QixFQUFnQm1ELEVBQWdCeEQsRUFBU3RCLEdBQ3pDaUIsRUFDRTZELEVBQWVsRSxjQUFjWixFQUFTRyxzQkFDdENILEdBRUYrRCxFQUFVWSxNQUlaLE1BQU1RLEVBQWV0RCxTQUFTVyxlQUFlLGlCQUN2QzRDLEVBQXVCRCxFQUFhdkUsY0FDeEMsNkJBRUl5RSxFQUFlRixFQUFhdkUsY0FBYyxpQkFDMUMwRSxFQUFpQkgsRUFBYXZFLGNBQWMsbUJBRTVDMkUsRUFBYUEsQ0FBQ0MsRUFBVUMsS0FDNUIsTUFBTUMsRUF3QlIsU0FBd0JDLEdBQ3RCLE1BQU1ELEVBQWNFLEVBQWFDLFdBQVUsR0FDckNDLEVBQVlKLEVBQVk5RSxjQUFjLGdCQUN0Q21GLEVBQVlMLEVBQVk5RSxjQUFjLGdCQUM1Q2tGLEVBQVVoRixZQUFjNkUsRUFBS0ssS0FDN0JELEVBQVVFLElBQU1OLEVBQUtLLEtBQ3JCRCxFQUFVaEQsSUFBTTRDLEVBQUtPLEtBMUdFQyxLQUN2QkEsRUFBUWpFLGlCQUFpQixTQUFTLEtBQ2hDaUUsRUFBUXBGLFVBQVVxRixPQUFPLDZCQTJHM0JDLENBRGdCWCxFQUFZOUUsY0FBYyxvQkFPMUMsTUE3R3dCMEYsRUFBQ0MsRUFBUWIsS0FDakNhLEVBQU9yRSxpQkFBaUIsU0FBUyxLQUMvQndELEVBQVkxRSxhQXVHZHNGLENBRGVaLEVBQVk5RSxjQUFjLGtCQUNmOEUsR0FuR0RjLEVBQUNULEVBQVdKLEtBQ3JDSSxFQUFVN0QsaUJBQWlCLFNBQVMsS0FDbENtRCxFQUFhdEMsSUFBTTRDLEVBQUtPLEtBQ3hCYixFQUFhWSxJQUFNTixFQUFLSyxLQUN4QlYsRUFBZXhFLFlBQWM2RSxFQUFLSyxLQUNsQ2pDLEVBQVVvQixPQWdHWnFCLENBQW1CVCxFQUFXSixHQUV2QkQsQ0FDVCxDQXhDc0JlLENBQWVqQixHQUNuQ0MsRUFBVWlCLFFBQVFoQixJQWVwQlosRUFBZTVDLGlCQUFpQixVQVpoQyxTQUFvQ3NDLEdBQ2xDQSxFQUFJQyxpQkFDSixNQUFNa0MsRUFBYyxDQUNsQlgsS0FBTWhCLEVBQWtCVCxNQUN4QjJCLEtBQU1uQixFQUFlUixPQUV2QmdCLEVBQVdvQixFQUFhQyxHQUN4QjlCLEVBQWVJLFFBQ2ZqRSxFQUFXNEQsRUFBYzdFLEdBQ3pCbUUsRUFBV1EsRUFDYixJQUlBLE1BQU1pQyxFQUFZL0UsU0FBU2pCLGNBQWMsZ0JBRW5DZ0YsRUFBZS9ELFNBQ2xCVyxlQUFlLG1CQUNmcUUsUUFBUWpHLGNBQWMsU0FtQnpCeUQsRUFBc0JlLEVBQXNCRCxHQXhMdkIsQ0FDbkIsQ0FDRWEsS0FBTSxvQkFDTkUsS0FBTSw4SEFHUixDQUNFRixLQUFNLGlEQUNORSxLQUFNLDBMQUdSLENBQ0VGLEtBQU0sMENBQ05FLEtBQU0sMExBR1IsQ0FDRUYsS0FBTSxrREFDTkUsS0FBTSx3TEFHUixDQUNFRixLQUFNLDhDQUNORSxLQUFNLHdMQUdSLENBQ0VGLEtBQU0sd0NBQ05FLEtBQU0sd0xBR1IsQ0FDRUYsS0FBTSx3REFDTkUsS0FBTSx5TEF5Skd0RSxTQUFTa0YsSUFDcEJ2QixFQUFXdUIsRUFBTUYsTUFJbkIsTUFBTTFDLEVBQXNCTSxJQUN0QkEsRUFBSXVDLE9BQU9oRyxVQUFVaUcsU0FBUyxvQkFDaEM3QyxFQUFXSyxFQUFJdUMsU0FLYjlDLEVBQWdCTyxJQUNwQixHQUFnQixXQUFaQSxFQUFJeUMsSUFBa0IsQ0FDeEIsTUFBTUMsRUFBY3JGLFNBQVNqQixjQUFjLG9CQUN2Q3NHLEdBQ0YvQyxFQUFXK0MsRUFFZixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idG5cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0X2luYWN0aXZlXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvclwiLFxufTtcblxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBlcnJvck1zZywgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IGVycm9yTXNnO1xuICBlcnJvck1zZ0VsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmVycm9yQ2xhc3MpOyAvLyBBZGQgdGhlIGVycm9yIGNsYXNzIHRvIHRoZSBlcnJvciBtZXNzYWdlXG4gIGlucHV0RWwuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTsgLy8gQWRkIHRoZSBlcnJvciBjbGFzcyB0byB0aGUgaW5wdXRcbn07XG5cbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IFwiXCI7IC8vIENsZWFyIHRoZSBlcnJvciBtZXNzYWdlXG4gIGVycm9yTXNnRWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuZXJyb3JDbGFzcyk7IC8vIFJlbW92ZSB0aGUgZXJyb3IgY2xhc3MgZnJvbSB0aGUgZXJyb3IgbWVzc2FnZVxuICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7IC8vIFJlbW92ZSB0aGUgZXJyb3IgY2xhc3MgZnJvbSB0aGUgaW5wdXRcbn07XG5cbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xuICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2UsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xuICB9XG59O1xuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGkpID0+IHtcbiAgcmV0dXJuIGlucHV0TGkuc29tZSgoaW5wdXRFbCkgPT4ge1xuICAgIHJldHVybiAhaW5wdXRFbC52YWxpZGl0eS52YWxpZDtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZGlzYWJsZUJ0biA9IChidXR0b25FbCwgY29uZmlnKSA9PiB7XG4gIGJ1dHRvbkVsLmRpc2FibGVkID0gdHJ1ZTtcbiAgYnV0dG9uRWwuY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG59O1xuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaSwgYnV0dG9uRWwsIGNvbmZpZykgPT4ge1xuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGkpKSB7XG4gICAgZGlzYWJsZUJ0bihidXR0b25FbCwgY29uZmlnKTtcbiAgfSBlbHNlIHtcbiAgICBidXR0b25FbC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIGJ1dHRvbkVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICB9XG59O1xuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsLCBjb25maWcpID0+IHtcbiAgY29uc3QgaW5wdXRMaSA9IEFycmF5LmZyb20oZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcbiAgY29uc3QgYnV0dG9uRWwgPSBmb3JtRWwucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpLCBidXR0b25FbCwgY29uZmlnKTtcbiAgaW5wdXRMaS5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGksIGJ1dHRvbkVsLCBjb25maWcpO1xuICAgIH0pO1xuICB9KTtcbn07XG5leHBvcnQgY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcbiAgY29uc3QgZm9ybUxpID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKTtcbiAgZm9ybUxpLmZvckVhY2goKGZvcm1FbCkgPT4ge1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbCwgY29uZmlnKTtcbiAgfSk7XG59O1xuZXhwb3J0IGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWwsIGlucHV0TGksIGNvbmZpZykgPT4ge1xuICBpbnB1dExpLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGNvbmZpZyk7XG4gIH0pO1xufTtcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuXG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuXG5pbXBvcnQge1xuICBlbmFibGVWYWxpZGF0aW9uLFxuICByZXNldFZhbGlkYXRpb24sXG4gIGRpc2FibGVCdG4sXG4gIHNldHRpbmdzLFxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5cbmltcG9ydCBoZWFkZXJMb2dvU3JjIGZyb20gXCIuLi9pbWFnZXMvTG9nby5zdmdcIjtcbmltcG9ydCBwcm9maWxlSW1nU3JjIGZyb20gXCIuLi9pbWFnZXMvYXZhdGFyLmpwZ1wiO1xuaW1wb3J0IHByb2ZpbGVFZGl0SW1nU3JjIGZyb20gXCIuLi9pbWFnZXMvR3JvdXAtMi5zdmdcIjtcbmltcG9ydCBwcm9maWxlQWRkSW1nU3JjIGZyb20gXCIuLi9pbWFnZXMvR3JvdXAtMjYuc3ZnXCI7XG5pbXBvcnQgbW9kYWxCbGFja1hTcmMgZnJvbSBcIi4uL2ltYWdlcy9jbG9zZS1pY29uYmxrLnN2Z1wiO1xuaW1wb3J0IG1vZGFsV2hpdGVYU3JjIGZyb20gXCIuLi9pbWFnZXMvY2xvc2UtaWNvbndodC5zdmdcIjtcblxuY29uc3QgaGVhZGVyTG9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaGVhZGVyX19sb2dvXCIpO1xuY29uc3QgcHJvZmlsZUltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZV9faW1hZ2VcIik7XG5jb25zdCBwcm9maWxlRWRpdEltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZV9fZWRpdC1idG4taW1nXCIpO1xuY29uc3QgcHJvZmlsZUFkZEltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZV9fYWRkLWJ0bi1pbWdcIik7XG5jb25zdCBlZGl0TW9kYWxCbGFja1ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1vZGFsX19jbG9zZS1idG4taW1nLWVkaXRcIik7XG5cbmNvbnN0IGFkZE1vZGFsQmxhY2tYID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtb2RhbF9fY2xvc2UtYnRuLWltZy1hZGRcIik7XG5jb25zdCBtb2RhbFdoaXRlWCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibW9kYWxfX2Nsb3NlLWJ0bi1pbWctd2h0ZVwiKTtcblxuaGVhZGVyTG9nby5zcmMgPSBoZWFkZXJMb2dvU3JjO1xucHJvZmlsZUltZy5zcmMgPSBwcm9maWxlSW1nU3JjO1xuZWRpdE1vZGFsQmxhY2tYLnNyYyA9IG1vZGFsQmxhY2tYU3JjO1xuYWRkTW9kYWxCbGFja1guc3JjID0gbW9kYWxCbGFja1hTcmM7XG5wcm9maWxlRWRpdEltZy5zcmMgPSBwcm9maWxlRWRpdEltZ1NyYztcbnByb2ZpbGVBZGRJbWcuc3JjID0gcHJvZmlsZUFkZEltZ1NyYztcblxubW9kYWxXaGl0ZVguc3JjID0gbW9kYWxXaGl0ZVhTcmM7XG5cbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiTGFuZHNjYXBlIGV4YW1wbGVcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNy1waG90by1ieS1ncmlmZmluLXdvb2xkcmlkZ2UtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG5cbiAge1xuICAgIG5hbWU6IFwiQSBtdWx0aS1zdG9yeSBsaWJyYXJ5IGZpbGxlZCB3aXRoIGJvb2tzaGVsdmVzLlwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE3NDE4NTA4MjA4ODItMWNiMDJkYTBmMDRmP3c9MTIwMCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZxPTYwJml4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4bVpXRjBkWEpsWkMxd2FHOTBiM010Wm1WbFpIdzFNSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0RcIixcbiAgfSxcblxuICB7XG4gICAgbmFtZTogXCJBIHByb3VkIGxpb25lc3MgcmVzdHMgYWRtaXN0IGhlciBwcmlkZS5cIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNzQxODUwODIwNTkxLWY2OTU0YTkwYzdiYT93PTEyMDAmYXV0bz1mb3JtYXQmZml0PWNyb3AmcT02MCZpeGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeG1aV0YwZFhKbFpDMXdhRzkwYjNNdFptVmxaSHcxTVh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEXCIsXG4gIH0sXG5cbiAge1xuICAgIG5hbWU6IFwiQSBtb2Rlcm4sIGFuZ3VsYXIgYnVpbGRpbmcgd2l0aCBhIGxhcmdlIHdpbmRvdy5cIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNzQxNTQwNDIwNzYyLTkxYTc4YmVjZGY5Mj93PTEyMDAmYXV0bz1mb3JtYXQmZml0PWNyb3AmcT02MCZpeGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeDBiM0JwWXkxbVpXVmtmREU1ZkUwNGFsWmlUR0pVVW5kemZIeGxibnd3Zkh4OGZIdyUzRFwiLFxuICB9LFxuXG4gIHtcbiAgICBuYW1lOiBcIlBlb3BsZSBwcmF5IGF0IGEgdGVtcGxlIHdpdGggaW5jZW5zZSBzbW9rZS5cIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNzQyMjY4MzUxMzM0LWJmOTMyOGYyOTNjZT93PTEyMDAmYXV0bz1mb3JtYXQmZml0PWNyb3AmcT02MCZpeGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeDBiM0JwWXkxbVpXVmtmREkyZkhSdmQwcGFSbk5yY0VkbmZIeGxibnd3Zkh4OGZIdyUzRFwiLFxuICB9LFxuXG4gIHtcbiAgICBuYW1lOiBcIlR3byBwZW9wbGUgaG9sZGluZyBoYW5kcyBvdmVyIGNvZmZlZS5cIixcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNzQxMjE3NTMxNDYwLWZiNTJiNDgxMDdiNj93PTEyMDAmYXV0bz1mb3JtYXQmZml0PWNyb3AmcT02MCZpeGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeDBiM0JwWXkxbVpXVmtmREV6ZkhocVVGSTBhR3hyUWtkQmZIeGxibnd3Zkh4OGZIdyUzRFwiLFxuICB9LFxuXG4gIHtcbiAgICBuYW1lOiBcIkdyYXkgbWV0YWwgY2hhbGtib2FyZCB3aXRoIHdoYXRldmVyIGl0IHRha2VzIHdyaXR0ZW4uXCIsXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTQ5MTIzNDMyMzkwNi00ZjA1NmNhNDE1YmM/dz0xMjAwJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnE9NjAmaXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHgwYjNCcFl5MW1aV1ZrZkRFNWZGOW9ZaTFrYkRSUkxUUlZmSHhsYm53d2ZIeDhmSHclM0RcIixcbiAgfSxcbl07XG4vL0VkaXQgcHJvZmlsZVxuY29uc3QgcHJvZmlsZUVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnRuXCIpO1xuY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIpO1xuY29uc3QgY2xvc2VFZGl0TW9kYWxCdG4gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcbmNvbnN0IGVkaXRQcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1wcm9maWxlXCJdO1xuXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XG5jb25zdCBlZGl0UHJvZmlsZU5hbWUgPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjbmFtZVwiKTtcbmNvbnN0IGVkaXRQcm9maWxlRGVzY3JpcHRpb24gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjZGVzY3JpcHRpb25cIik7XG5cbmNvbnN0IG9wZW5Nb2RhbCA9IChtb2RhbCkgPT4ge1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfaXMtb3BlbmVkXCIpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NLZXkpO1xuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlT3ZlcmxheUNsaWNrKTtcbn07XG5cbmNvbnN0IGNsb3NlTW9kYWwgPSBmdW5jdGlvbiAobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX2lzLW9wZW5lZFwiKTtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjS2V5KTtcbiAgbW9kYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZU92ZXJsYXlDbGljayk7XG59O1xuXG5jb25zdCBhZGRPcGVuTW9kYWxMaXN0ZW5lciA9ICh0cmlnZ2VyLCBtb2RhbCkgPT4ge1xuICB0cmlnZ2VyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBvcGVuTW9kYWwobW9kYWwpKTtcbn07XG5cbmNvbnN0IGFkZENsb3NlTW9kYWxMaXN0ZW5lciA9IChidXR0b24sIG1vZGFsKSA9PiB7XG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChtb2RhbCkpO1xufTtcblxuY29uc3QgYWRkTGlrZUxpc3RlbmVyID0gKGxpa2VCdG4pID0+IHtcbiAgbGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGxpa2VCdG4uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnRuX2FjdGl2ZVwiKTtcbiAgfSk7XG59O1xuXG5jb25zdCBhZGREZWxldGVMaXN0ZW5lciA9IChkZWxCdG4sIGNhcmRFbGVtZW50KSA9PiB7XG4gIGRlbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGNhcmRFbGVtZW50LnJlbW92ZSgpO1xuICB9KTtcbn07XG5cbmNvbnN0IGFkZFByZXZpZXdMaXN0ZW5lciA9IChjYXJkSW1hZ2UsIGRhdGEpID0+IHtcbiAgY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgcHJldmlld0ltYWdlLnNyYyA9IGRhdGEubGluaztcbiAgICBwcmV2aWV3SW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xuICAgIHByZXZpZXdDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xuICB9KTtcbn07XG5cbnByb2ZpbGVFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRQcm9maWxlTmFtZS52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xuICBlZGl0UHJvZmlsZURlc2NyaXB0aW9uLnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xuICBjb25zdCBpbnB1dExpID0gQXJyYXkuZnJvbShcbiAgICBlZGl0UHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxuICApO1xuICByZXNldFZhbGlkYXRpb24oZWRpdFByb2ZpbGVGb3JtLCBpbnB1dExpLCBzZXR0aW5ncyk7XG4gIG9wZW5Nb2RhbChwcm9maWxlRWRpdE1vZGFsKTtcbn0pO1xuYWRkQ2xvc2VNb2RhbExpc3RlbmVyKGNsb3NlRWRpdE1vZGFsQnRuLCBwcm9maWxlRWRpdE1vZGFsKTtcblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGVkaXRQcm9maWxlTmFtZS52YWx1ZTtcbiAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZWRpdFByb2ZpbGVEZXNjcmlwdGlvbi52YWx1ZTtcbiAgY2xvc2VNb2RhbChwcm9maWxlRWRpdE1vZGFsKTtcbn1cblxuZWRpdFByb2ZpbGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpO1xuXG4vLyBBZGQgcG9zdFxuY29uc3QgcHJvZmlsZUFkZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ0blwiKTtcbmNvbnN0IHByb2ZpbGVBZGRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXBvc3QtbW9kYWxcIik7XG5jb25zdCBjbG9zZUFkZE1vZGFsQnRuID0gcHJvZmlsZUFkZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcbmNvbnN0IG1vZGFsU2F2ZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5cIik7XG5jb25zdCBwcm9maWxlQWRkRm9ybSA9IHByb2ZpbGVBZGRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuXG5jb25zdCBwcm9maWxlQWRkTGluayA9IHByb2ZpbGVBZGRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2xpbmtcIik7XG5jb25zdCBwcm9maWxlQWRkQ2FwdGlvbiA9IHByb2ZpbGVBZGRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2NhcHRpb25cIik7XG5cbmFkZE9wZW5Nb2RhbExpc3RlbmVyKHByb2ZpbGVBZGRCdG4sIHByb2ZpbGVBZGRNb2RhbCk7XG5hZGRDbG9zZU1vZGFsTGlzdGVuZXIoY2xvc2VBZGRNb2RhbEJ0biwgcHJvZmlsZUFkZE1vZGFsKTtcblxucHJvZmlsZUFkZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBwcm9maWxlQWRkRm9ybS5yZXNldCgpOyAvLyBPcHRpb25hbCBpZiB5b3Ugd2FudCB0byBjbGVhciBpdCBleHBsaWNpdGx5IG9uIG9wZW5cbiAgY29uc3QgaW5wdXRMaSA9IEFycmF5LmZyb20oXG4gICAgcHJvZmlsZUFkZEZvcm0ucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxuICApO1xuICByZXNldFZhbGlkYXRpb24ocHJvZmlsZUFkZEZvcm0sIGlucHV0TGksIHNldHRpbmdzKTtcbiAgZGlzYWJsZUJ0bihcbiAgICBwcm9maWxlQWRkRm9ybS5xdWVyeVNlbGVjdG9yKHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKSxcbiAgICBzZXR0aW5nc1xuICApO1xuICBvcGVuTW9kYWwocHJvZmlsZUFkZE1vZGFsKTtcbn0pO1xuXG4vLyBQcmV2aWV3IGltYWdlXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByZXZpZXctbW9kYWxcIik7XG5jb25zdCBjbG9zZVByZXZpZXdNb2RhbEJ0biA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9fY2xvc2UtYnRuX3ByZXZpZXdcIlxuKTtcbmNvbnN0IHByZXZpZXdJbWFnZSA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbmNvbnN0IHByZXZpZXdDYXB0aW9uID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XG5cbmNvbnN0IHJlbmRlckNhcmQgPSAoY2FyZERhdGEsIGNvbnRhaW5lcikgPT4ge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGNhcmREYXRhKTsgLy8gQ3JlYXRlIHRoZSBjYXJkIGVsZW1lbnRcbiAgY29udGFpbmVyLnByZXBlbmQoY2FyZEVsZW1lbnQpOyAvLyBBZGQgdGhlIGNhcmQgZWxlbWVudCB0byB0aGUgY29udGFpbmVyXG59O1xuXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlQWRkRm9ybVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IGlucHV0VmFsdWVzID0ge1xuICAgIG5hbWU6IHByb2ZpbGVBZGRDYXB0aW9uLnZhbHVlLFxuICAgIGxpbms6IHByb2ZpbGVBZGRMaW5rLnZhbHVlLFxuICB9O1xuICByZW5kZXJDYXJkKGlucHV0VmFsdWVzLCBjYXJkc0xpc3QpO1xuICBwcm9maWxlQWRkRm9ybS5yZXNldCgpO1xuICBkaXNhYmxlQnRuKG1vZGFsU2F2ZUJ0biwgc2V0dGluZ3MpO1xuICBjbG9zZU1vZGFsKHByb2ZpbGVBZGRNb2RhbCk7XG59XG5cbnByb2ZpbGVBZGRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlUHJvZmlsZUFkZEZvcm1TdWJtaXQpO1xuXG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudFxuICAuZ2V0RWxlbWVudEJ5SWQoXCJjYXJkc19fdGVtcGxhdGVcIilcbiAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpO1xuXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNsb25lTm9kZSh0cnVlKTtcbiAgY29uc3QgY2FyZFRpdGxlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgY29uc3QgY2FyZEltYWdlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICBjYXJkSW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xuICBjYXJkSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xuXG4gIGNvbnN0IGxpa2VCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnRuXCIpO1xuICBhZGRMaWtlTGlzdGVuZXIobGlrZUJ0bik7XG4gIGNvbnN0IGRlbEJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsLWJ0blwiKTtcbiAgYWRkRGVsZXRlTGlzdGVuZXIoZGVsQnRuLCBjYXJkRWxlbWVudCk7XG5cbiAgYWRkUHJldmlld0xpc3RlbmVyKGNhcmRJbWFnZSwgZGF0YSk7XG5cbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuYWRkQ2xvc2VNb2RhbExpc3RlbmVyKGNsb3NlUHJldmlld01vZGFsQnRuLCBwcmV2aWV3TW9kYWwpO1xuXG5pbml0aWFsQ2FyZHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICByZW5kZXJDYXJkKGl0ZW0sIGNhcmRzTGlzdCk7XG59KTtcblxuLy8gRnVuY3Rpb24gdG8gY2xvc2UgdGhlIG1vZGFsIHdoZW4gY2xpY2tpbmcgb3V0c2lkZSBpdHMgYm9yZGVyc1xuY29uc3QgaGFuZGxlT3ZlcmxheUNsaWNrID0gKGV2dCkgPT4ge1xuICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9pcy1vcGVuZWRcIikpIHtcbiAgICBjbG9zZU1vZGFsKGV2dC50YXJnZXQpO1xuICB9XG59O1xuXG4vLyBGdW5jdGlvbiB0byBjbG9zZSB0aGUgbW9kYWwgd2hlbiBwcmVzc2luZyB0aGUgRXNjIGtleVxuY29uc3QgaGFuZGxlRXNjS2V5ID0gKGV2dCkgPT4ge1xuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgIGNvbnN0IG9wZW5lZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9pcy1vcGVuZWRcIik7XG4gICAgaWYgKG9wZW5lZE1vZGFsKSB7XG4gICAgICBjbG9zZU1vZGFsKG9wZW5lZE1vZGFsKTtcbiAgICB9XG4gIH1cbn07XG5cbi8vIEFkZCBldmVudCBsaXN0ZW5lcnMgZm9yIGFsbCBtb2RhbHNcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsIiwiaW5wdXRFbCIsImNvbmZpZyIsImVycm9yTXNnRWwiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJ0ZXh0Q29udGVudCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImRpc2FibGVCdG4iLCJidXR0b25FbCIsImRpc2FibGVkIiwiYWRkIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpIiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJyZXNldFZhbGlkYXRpb24iLCJmb3JFYWNoIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJBcnJheSIsImZyb20iLCJhZGRFdmVudExpc3RlbmVyIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1zZyIsInZhbGlkYXRpb25NZXNzYWdlIiwiaGVhZGVyTG9nbyIsImdldEVsZW1lbnRCeUlkIiwicHJvZmlsZUltZyIsInByb2ZpbGVFZGl0SW1nIiwicHJvZmlsZUFkZEltZyIsImVkaXRNb2RhbEJsYWNrWCIsImFkZE1vZGFsQmxhY2tYIiwibW9kYWxXaGl0ZVgiLCJzcmMiLCJoZWFkZXJMb2dvU3JjIiwicHJvZmlsZUltZ1NyYyIsIm1vZGFsQmxhY2tYU3JjIiwicHJvZmlsZUVkaXRJbWdTcmMiLCJwcm9maWxlQWRkSW1nU3JjIiwibW9kYWxXaGl0ZVhTcmMiLCJwcm9maWxlRWRpdEJ0biIsInByb2ZpbGVFZGl0TW9kYWwiLCJjbG9zZUVkaXRNb2RhbEJ0biIsImVkaXRQcm9maWxlRm9ybSIsImZvcm1zIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJlZGl0UHJvZmlsZU5hbWUiLCJlZGl0UHJvZmlsZURlc2NyaXB0aW9uIiwib3Blbk1vZGFsIiwibW9kYWwiLCJoYW5kbGVFc2NLZXkiLCJoYW5kbGVPdmVybGF5Q2xpY2siLCJjbG9zZU1vZGFsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImFkZENsb3NlTW9kYWxMaXN0ZW5lciIsImJ1dHRvbiIsInZhbHVlIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJwcm9maWxlQWRkQnRuIiwicHJvZmlsZUFkZE1vZGFsIiwiY2xvc2VBZGRNb2RhbEJ0biIsIm1vZGFsU2F2ZUJ0biIsInByb2ZpbGVBZGRGb3JtIiwicHJvZmlsZUFkZExpbmsiLCJwcm9maWxlQWRkQ2FwdGlvbiIsImFkZE9wZW5Nb2RhbExpc3RlbmVyIiwicmVzZXQiLCJwcmV2aWV3TW9kYWwiLCJjbG9zZVByZXZpZXdNb2RhbEJ0biIsInByZXZpZXdJbWFnZSIsInByZXZpZXdDYXB0aW9uIiwicmVuZGVyQ2FyZCIsImNhcmREYXRhIiwiY29udGFpbmVyIiwiY2FyZEVsZW1lbnQiLCJkYXRhIiwiY2FyZFRlbXBsYXRlIiwiY2xvbmVOb2RlIiwiY2FyZFRpdGxlIiwiY2FyZEltYWdlIiwibmFtZSIsImFsdCIsImxpbmsiLCJsaWtlQnRuIiwidG9nZ2xlIiwiYWRkTGlrZUxpc3RlbmVyIiwiYWRkRGVsZXRlTGlzdGVuZXIiLCJkZWxCdG4iLCJhZGRQcmV2aWV3TGlzdGVuZXIiLCJnZXRDYXJkRWxlbWVudCIsInByZXBlbmQiLCJpbnB1dFZhbHVlcyIsImNhcmRzTGlzdCIsImNvbnRlbnQiLCJpdGVtIiwidGFyZ2V0IiwiY29udGFpbnMiLCJrZXkiLCJvcGVuZWRNb2RhbCJdLCJzb3VyY2VSb290IjoiIn0=